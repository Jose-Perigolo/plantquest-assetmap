{"version":3,"file":"index.js","sources":["../src/leaflet.toolbar.min.js","../node_modules/leaflet-rastercoords/rastercoords.js","../src/pqam.js"],"sourcesContent":["/* @preserve MIT LICENSE, Copyright (c) 2014-2015, Justin Manley */\n!function(t,o,i){\"use strict\";t.L.Toolbar2=(L.Layer||L.Class).extend({statics:{baseClass:\"leaflet-toolbar\"},options:{className:\"\",filter:function(){return!0},actions:[]},initialize:function(t){L.setOptions(this,t),this._toolbar_type=this.constructor._toolbar_class_id},addTo:function(t){return this._arguments=[].slice.call(arguments),t.addLayer(this),this},onAdd:function(t){var o=t._toolbars[this._toolbar_type];0===this._calculateDepth()&&(o&&t.removeLayer(o),t._toolbars[this._toolbar_type]=this)},onRemove:function(t){0===this._calculateDepth()&&delete t._toolbars[this._toolbar_type]},appendToContainer:function(t){var o,i,e,n,s=this.constructor.baseClass+\"-\"+this._calculateDepth()+\" \"+this.options.className;for(this._container=t,this._ul=L.DomUtil.create(\"ul\",s,t),this._disabledEvents=[\"click\",\"mousemove\",\"dblclick\",\"mousedown\",\"mouseup\",\"touchstart\"],i=0,n=this._disabledEvents.length;i<n;i++)L.DomEvent.on(this._ul,this._disabledEvents[i],L.DomEvent.stopPropagation);for(o=0,e=this.options.actions.length;o<e;o++)(new(this._getActionConstructor(this.options.actions[o])))._createIcon(this,this._ul,this._arguments)},_getActionConstructor:function(t){var o=this._arguments,i=this;return t.extend({initialize:function(){t.prototype.initialize.apply(this,o)},enable:function(o){i._active&&i._active.disable(),i._active=this,t.prototype.enable.call(this,o)}})},_hide:function(){this._ul.style.display=\"none\"},_show:function(){this._ul.style.display=\"block\"},_calculateDepth:function(){for(var t=0,o=this.parentToolbar;o;)t+=1,o=o.parentToolbar;return t}}),L.Evented||L.Toolbar2.include(L.Mixin.Events),L.toolbar={};var e=0;L.Toolbar2.extend=function(t){var o=L.extend({},t.statics,{_toolbar_class_id:e});return e+=1,L.extend(t,{statics:o}),L.Class.extend.call(this,t)},L.Map.addInitHook(function(){this._toolbars={}}),L.Toolbar2.Action=L.Handler.extend({statics:{baseClass:\"leaflet-toolbar-icon\"},options:{toolbarIcon:{html:\"\",className:\"\",tooltip:\"\"},subToolbar:new L.Toolbar2},initialize:function(t){var o=L.Toolbar2.Action.prototype.options.toolbarIcon;L.setOptions(this,t),this.options.toolbarIcon=L.extend({},o,this.options.toolbarIcon)},enable:function(t){t&&L.DomEvent.preventDefault(t),this._enabled||(this._enabled=!0,this.addHooks&&this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks&&this.removeHooks())},_createIcon:function(t,o,i){var e=this.options.toolbarIcon;this.toolbar=t,this._icon=L.DomUtil.create(\"li\",\"\",o),this._link=L.DomUtil.create(\"a\",\"\",this._icon),this._link.innerHTML=e.html,this._link.setAttribute(\"href\",\"#\"),this._link.setAttribute(\"title\",e.tooltip),L.DomUtil.addClass(this._link,this.constructor.baseClass),e.className&&L.DomUtil.addClass(this._link,e.className),L.DomEvent.on(this._link,\"click\",this.enable,this),this._addSubToolbar(t,this._icon,i)},_addSubToolbar:function(t,o,i){var e=this.options.subToolbar,n=this.addHooks,s=this.removeHooks;e.parentToolbar=t,e.options.actions.length>0&&((i=[].slice.call(i)).push(this),e.addTo.apply(e,i),e.appendToContainer(o),this.addHooks=function(t){\"function\"==typeof n&&n.call(this,t),e._show()},this.removeHooks=function(t){\"function\"==typeof s&&s.call(this,t),e._hide()})}}),L.toolbarAction=function(t){return new L.Toolbar2.Action(t)},L.Toolbar2.Action.extendOptions=function(t){return this.extend({options:t})},L.Toolbar2.Control=L.Toolbar2.extend({statics:{baseClass:\"leaflet-control-toolbar \"+L.Toolbar2.baseClass},initialize:function(t){L.Toolbar2.prototype.initialize.call(this,t),this._control=new L.Control.Toolbar(this.options)},onAdd:function(t){this._control.addTo(t),L.Toolbar2.prototype.onAdd.call(this,t),this.appendToContainer(this._control.getContainer())},onRemove:function(t){L.Toolbar2.prototype.onRemove.call(this,t),this._control.remove?this._control.remove():this._control.removeFrom(t)}}),L.Control.Toolbar=L.Control.extend({onAdd:function(){return L.DomUtil.create(\"div\",\"\")}}),L.toolbar.control=function(t){return new L.Toolbar2.Control(t)},L.Toolbar2.Popup=L.Toolbar2.extend({statics:{baseClass:\"leaflet-popup-toolbar \"+L.Toolbar2.baseClass},options:{anchor:[0,0]},initialize:function(t,o){L.Toolbar2.prototype.initialize.call(this,o),this._marker=new L.Marker(t,{icon:new L.DivIcon({className:this.options.className,iconAnchor:[0,0]})})},onAdd:function(t){this._map=t,this._marker.addTo(t),L.Toolbar2.prototype.onAdd.call(this,t),this.appendToContainer(this._marker._icon),this._setStyles()},onRemove:function(t){t.removeLayer(this._marker),L.Toolbar2.prototype.onRemove.call(this,t),delete this._map},setLatLng:function(t){return this._marker.setLatLng(t),this},_setStyles:function(){for(var t,o,i,e=this._container,n=this._ul,s=L.point(this.options.anchor),a=n.querySelectorAll(\".leaflet-toolbar-icon\"),l=[],r=0,c=0,h=a.length;c<h;c++)a[c].parentNode.parentNode===n&&(l.push(parseInt(L.DomUtil.getStyle(a[c],\"height\"),10)),r+=Math.ceil(parseFloat(L.DomUtil.getStyle(a[c],\"width\"))),r+=Math.ceil(parseFloat(L.DomUtil.getStyle(a[c],\"border-right-width\"))));n.style.width=r+\"px\",this._tipContainer=L.DomUtil.create(\"div\",\"leaflet-toolbar-tip-container\",e),this._tipContainer.style.width=r+Math.ceil(parseFloat(L.DomUtil.getStyle(n,\"border-left-width\")))+\"px\",this._tip=L.DomUtil.create(\"div\",\"leaflet-toolbar-tip\",this._tipContainer),t=Math.max.apply(void 0,l),n.style.height=t+\"px\",o=parseInt(L.DomUtil.getStyle(this._tip,\"width\"),10),i=new L.Point(r/2,t+1.414*o),e.style.marginLeft=s.x-i.x+\"px\",e.style.marginTop=s.y-i.y+\"px\"}}),L.toolbar.popup=function(t){return new L.Toolbar2.Popup(t)}}(window,document);\n","/**\n * leaflet plugin for plain image map projection\n * @copyright 2016- commenthol\n * @license MIT\n */\n/* globals define */\n/* eslint no-var:off */\n\n;(function (factory) {\n  var L\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['leaflet'], factory)\n  } else if (typeof module !== 'undefined') {\n    // Node/CommonJS\n    L = require('leaflet')\n    module.exports = factory(L)\n  } else {\n    // Browser globals\n    if (typeof window.L === 'undefined') {\n      throw new Error('Leaflet must be loaded first')\n    }\n    factory(window.L)\n  }\n}(function (L) {\n  /**\n   * L.RasterCoords\n   * @param {L.map} map - the map used\n   * @param {Array} imgsize - [ width, height ] image dimensions\n   * @param {Number} [tilesize] - tilesize in pixels. Default=256\n   * @param {Boolean} setmaxbounds - automatically set map max bounds. Default=true\n   */\n  L.RasterCoords = function (map, imgsize, tilesize, setmaxbounds = true) {\n    this.map = map\n    this.width = imgsize[0]\n    this.height = imgsize[1]\n    this.tilesize = tilesize || 256\n    this.zoom = this.zoomLevel()\n    if (setmaxbounds && this.width && this.height) {\n      this.setMaxBounds()\n    }\n  }\n\n  L.RasterCoords.prototype = {\n    /**\n     * calculate accurate zoom level for the given image size\n     */\n    zoomLevel: function () {\n      return Math.ceil(\n        Math.log(\n          Math.max(this.width, this.height) /\n          this.tilesize\n        ) / Math.log(2)\n      )\n    },\n    /**\n     * unproject `coords` to the raster coordinates used by the raster image projection\n     * @param {Array} coords - [ x, y ]\n     * @return {L.LatLng} - internal coordinates\n     */\n    unproject: function (coords) {\n      return this.map.unproject(coords, this.zoom)\n    },\n    /**\n     * project `coords` back to image coordinates\n     * @param {Array} coords - [ x, y ]\n     * @return {L.LatLng} - image coordinates\n     */\n    project: function (coords) {\n      return this.map.project(coords, this.zoom)\n    },\n    /**\n     * get the max bounds of the image\n     */\n    getMaxBounds: function () {\n      var southWest = this.unproject([0, this.height])\n      var northEast = this.unproject([this.width, 0])\n      return new L.LatLngBounds(southWest, northEast)\n    },\n    /**\n     * sets the max bounds on map\n     */\n    setMaxBounds: function () {\n      var bounds = this.getMaxBounds()\n      this.map.setMaxBounds(bounds)\n    }\n  }\n\n  return L.RasterCoords\n}))\n; // eslint-disable-line semi\n","/* Copyright 2022-2023 PlantQuest Ltd, MIT License */\n\nimport L from 'leaflet'\nimport './leaflet.toolbar.min.js'\nimport 'leaflet.markercluster'\n\n\nimport Pkg from '../package.json'\n\n\nimport Seneca from 'seneca-browser'\nimport SenecaEntity from 'seneca-entity'\n\nimport '../node_modules/leaflet-rastercoords/rastercoords.js'\n\n\n;(function(W, D) {\n\n  W.PLANTQUEST_ASSETMAP_DEBUG = {}\n  \n  const log = (...args) => {\n    if(true === W.PLANTQUEST_ASSETMAP_LOG || 'ERROR' === args[1]) {\n      console.log.apply(null, args)\n    }\n  }\n  \n  const scriptID = (''+Math.random()).substring(2,8)\n\n  log('PQAM','script-load', 'start', 'version=', Pkg.version, 'scriptid=', scriptID)\n\n  if(W.PlantQuestAssetMap) {\n    log('PQAM','script-load', 'exists', scriptID, W.PlantQuestAssetMap.id)\n    return\n  }\n  else {\n    log('PQAM','script-load', 'create', scriptID)\n  }\n  \n  let $ = D.querySelector.bind(D)\n  let $All = D.querySelectorAll.bind(D)\n  let Element = D.createElement.bind(D)\n  \n  let rc\n  \n  function PlantQuestAssetMap() {\n    const self = {\n      id: (''+Math.random()).substring(2,8),\n      info: {\n        name: '@plantquest/assetmap',\n        version: Pkg.version,\n      },\n      \n      // default config\n      config: {\n        width: '100%',\n        height: '100%',\n        domInterval: 111,\n        mapInterval: 111,\n        mapBounds: [5850, 7800],\n        mapImg: [7800, 5850],\n        mapStart: [3000, 2200],\n        mapStartZoom: 2,\n        mapRoomFocusZoom: 5,\n        mapMinZoom: 2,\n        mapMaxZoom: 6,\n        assetFontScaleRoom: 10,\n        assetFontScaleZoom: 4,\n        assetFontHideZoom: -1,\n        showAllAssets: true,\n\n        debugClick: false,\n        infobox: {\n          show: false,\n          single: true,\n        },\n        \n        data: 'https://demo.plantquest.app/sample-data.js',\n        mode: 'demo',\n        apikey: '<API KEY>',\n        endpoint: '/',\n        tilesEndPoint: 'https://demo.plantquest.app/tiles',\n\n        states: {\n          up: { color: '#99f', name: 'Up', marker: 'standard' },\n          down: { color: '#666', name: 'Down', marker: 'standard' },\n          missing: { color: '#f9f', name: 'Missing', marker: 'alert' },\n          alarm: { color: '#f99', name: 'Alarm', marker: 'alert' },\n        },\n        \n        map: [],\n        start: {\n          map: 0,\n          level: 0,\n        },\n\n        room: {\n          color: '#33f',\n        },\n\n        label: {\n          zoom: null // null => appear at mapMaxZoom\n        },\n\n        plants: [],\n\n        asset: {\n          cluster: true\n        }\n      },\n      data: {},\n      assetMap: {},\n      roomMap: {},\n      current: {\n        started: false,\n        room: {},\n        asset: {},\n        assetInfoShown: {},\n      },\n      upload: {\n        assetI: 0,\n        interval: null,\n      },\n      listeners: [],\n    }\n\n    self.log = function(...args) {\n      log('PQAM', ...args)\n    }\n    \n    \n    self.start = function(config) {\n      if(self.current.started) {\n        self.clearRoomAssets()\n        self.unselectRoom()\n        \n        self.map.setView(self.config.mapStart, self.config.mapStartZoom)\n        return\n      }\n      \n      self.config = { ...self.config, ...(config || {}) }\n      self.log('start', JSON.stringify(config))\n      \n      self.config.base = self.config.base || ''\n\n      if(!self.config.base.endsWith('/')) {\n        self.config.base += '/'\n      }\n      \n      function loading() {\n        self.target = $('#plantquest-assetmap')\n        if(!self.target) {\n          self.log('ERROR', 'element-id', 'plantquest-assetmap', 'missing')\n          clearInterval(loadingInterval)\n          return\n        }\n                \n        if (null != self.target && false === self.current.started) {\n          self.current.started = true\n\n          self.target.style.width = self.config.width\n          self.target.style.height = self.config.height\n\n          clearInterval(loadingInterval)\n          self.log('start','target-found',self.target)\n\n          self.log(\n            'start','target-size',\n            'widthcss',self.config.width,\n            'heightcss',self.config.height,\n          )\n          \n          self.load(()=>{\n            self.log('start','load-done',self.data)\n            \n            self.render(()=>{\n              self.log('start','render-done')\n              \n              self.emit({\n                srv:'plantquest',\n                part:'assetmap',\n                state: 'ready'\n              })\n            })\n          })\n        }\n      }\n\n      const loadingInterval = setInterval(loading, 50)\n    }\n\n    \n    self.load = async function(done) {\n\n      let seneca = await self.getSeneca()\n                  \n      function reset() {\n        // reset\n        self.data.deps = {}\n        self.data.roomMap = {}\n        self.data.assetMap = {}\n        self.data.assets = []\n        self.data.rooms = []\n        self.data.buildings = []\n        self.data.levels = []\n        self.data.maps = []\n      }\n      \n      async function processData(json) {\n      \n        self.data = json\n        \n        let assets = []\n        let assetMap = {}\n        \n        \n        let assetProps = self.data.assets[0]\n        for(let rowI = 1; rowI < self.data.assets.length; rowI++) {\n          let row = self.data.assets[rowI]\n          let assetID = row[0]\n          assetMap[assetID] = assetProps.reduce((a,p,i)=>((a[p]=row[i]),a),{})\n        }\n            \n        \n        self.data.assetMap = assetMap\n        \n        \n        let roomMap = self.data.rooms.reduce((a,r)=>(a[r.room]=r,a),{})\n        self.data.roomMap = roomMap\n        \n        self.log('data loaded')\n\n  \n  \n        done(json)\n        \n      }\n      \n      async function loadData() {\n        if(self.dataLoaded) {\n          done(self.data)\n          return\n        }\n        \n        let query = {\n          project_id: self.config.project_id,\n          plant_id: self.config.plant_id,\n          stage: self.config.stage,\n        }\n\n        let{ assets } =\n            await seneca.post('srv:plantquest,part:assetmap,list:asset',\n                              { query, } )\n        let{ rooms } =\n            await seneca.post('srv:plantquest,part:assetmap,list:room',\n                              { query, } )\n        let{ buildings } =\n            await seneca.post('srv:plantquest,part:assetmap,list:building',\n                              { query, } )\n        \n        self.data.assets = assets\n        self.data.rooms = rooms\n        \n        self.data.deps = {}\n        \n        let {\n          deps,\n          maps,\n          levels,\n          // buildings,\n          assetMap,\n          roomMap\n        } = generate( { assets, rooms } )\n        \n        self.data.buildings = buildings\n        self.data.levels = levels\n        self.data.maps = maps\n        \n        self.data.assetMap = assetMap\n        self.data.roomMap = roomMap\n        \n        self.data.deps = deps\n        self.dataLoaded = true\n        \n        done(self.data)\n        \n      }\n      \n      if(self.config.mode == 'demo') {\n      \n        if('https://demo.plantquest.app/sample-data.js' === self.config.data) {\n          const head = $('head')\n          const skript = document.createElement('script')\n          skript.setAttribute('src', self.config.data)\n          head.appendChild(skript)\n\n          let waiter = setInterval(()=>{\n            self.log('loading data...')\n            if(W.PLANTQUEST_ASSETMAP_DATA) {\n            \n              clearInterval(waiter)\n              processData(W.PLANTQUEST_ASSETMAP_DATA)\n            }\n          },111)\n        }\n        else {\n          fetch(self.config.data)\n            .then(response => {\n              if (!response.ok) {\n                throw new Error(\"HTTP error \" + response.status)\n              }\n              return response.json()\n            })\n            .then(json => processData(json))\n            .catch((err)=>self.log('ERROR','load',err))\n        }\n      } else if (self.config.mode == 'live') {\n        loadData()\n      }\n    }\n\n    \n    self.render = function(done) {      \n      injectStyle()\n      \n      let root = Element('div')\n      root.style.boxSizing = 'border-box'\n      root.style.width = '100%'\n      root.style.height = '100%'\n      root.style.backgroundColor = 'rgb(203,211,144)'\n      root.style.padding = '0px'\n      root.style.textAlign = 'center'\n      root.style.position = 'relative'\n      root.innerHTML = buildContainer()\n      self.target.appendChild(root)\n      \n\n      setTimeout(()=>{\n        self.vis.map.elem = $('#plantquest-assetmap-map')\n        self.build()\n        self.showMap(0)\n        done()\n      }, self.domInterval)\n    }\n\n    self.send = async function(msg) {\n      self.log('send', 'in', msg)\n      \n      let result = await self.seneca.post(msg)\n      \n      if(null != msg.zoom) {\n        self.map.setZoom(msg.zoom)\n      }\n      \n      if(null != msg.view) {\n        self.map.setView(msg.view, msg.zoom || self.config.mapMinZoom)\n      }\n\n      return result\n    }\n\n    self.listen = function(listener) {\n      if(null == listener || 'function' !== typeof(listener)) {\n        self.log('ERROR', 'listen', 'bad-listener', listener)\n                 \n      }\n      else {\n        self.listeners.push(listener)\n        self.log('listen', 'set-listener',\n                 '<<'+listener.toString()\n                 .substring(0,77).replace(/[\\r\\n]/g,'')+'...>>')\n      }\n    }\n\n    \n    self.click = function(what, event) {\n      // event && event.stopPropagation()\n      let msg = Object.assign({\n        srv:'plantquest',\n        part:'assetmap',\n      }, what)\n      self.log('click',msg)\n      self.emit(msg)\n    }\n\n    \n    self.emit = function(msg) {\n      self.log('send', msg)\n      self.listeners.forEach(listener=>{\n        try {\n          listener(msg)\n        }\n        catch(e) {\n          self.log('ERROR', 'emit', 'listener', e, msg, listener)\n        }\n      })\n    }\n\n\n    self.vis = {\n      map: {\n      },\n      ctrl: {\n      }\n    }\n    \n\n    self.loc = {\n      x: 0,\n      y: 0,\n      poly: null,\n      room: null,\n      chosen: {\n        poly: null,\n        room: null,\n      },\n      stateShown: {},\n      asset: {},\n      map: -1,\n    }\n\n    self.leaflet = {\n\n    }\n    \n    self.map = null\n    self.layer = {}\n\n    \n    self.build = function() {\n      let ms = {\n        mapurl: self.config.map[self.config.start.map],\n        bounds: [[0, 0], [...self.config.mapBounds]]\n      }\n\n      self.log('build', ms, L)\n      \n      \n      self.map = L.map('plantquest-assetmap-map', {\n        crs: L.CRS.Simple,\n        scrollWheelZoom: true,\n        doubleClickZoom: false,\n        attributionControl: false,\n        minZoom: self.config.mapMinZoom,\n        maxZoom: self.config.mapMaxZoom,\n      })\n      rc = self.rc = new L.RasterCoords(self.map, self.config.mapImg)\n\n      // Place labels in separate Pane to ensure ordering below assets,\n      // prevents lost click events.\n      self.map.createPane('labels')\n      self.map.getPane('labels').style.zIndex = 220\n      self.map.getPane('labels').style.pointerEvents = 'none'\n      \n      self.layer.room = L.layerGroup().addTo(self.map)\n      self.layer.room.name$ = 'room'\n      \n      self.layer.label = L.layerGroup().addTo(self.map)\n      self.layer.label.name$ = 'label'\n      \n      self.map.on('zoomstart', self.zoomStartRender)\n      self.map.on('zoomend', self.zoomEndRender)\n      \n      setTimeout(()=>{\n        let mapStart = c_asset_coords({x: self.config.mapStart[0], y: self.config.mapImg[1]-self.config.mapStart[1]})\n        self.map.setView(mapStart, self.config.mapStartZoom)\n        \n        self.leaflet.mapCenter = self.map.getCenter()\n        \n      },self.config.mapInterval/2)\n      \n      // L.imageOverlay(ms.mapurl, ms.bounds).addTo(self.map);\n\n\n      \n\n      if( self.config.asset.cluster) {\n        self.layer.circles = L.layerGroup().addTo(self.map)\n        self.layer.circles.name$ = 'circles'\n                \n        self.layer.asset = L.markerClusterGroup({\n          animateAddingMarkers: false,\n          spiderfyOnMaxZoom: false,\n          showCoverageOnHover: false,\n          // zoomToBoundsOnClick: true,\n          zoomToBoundsOnClick: false,\n          // singleMarkerMode: true,\n          // spiderfyDistanceMultiplier: -100,\n          maxClusterRadius: 40,\n          chunkedLoading: true,\n\n          spiderLegPolylineOptions: { weight: 1.5, color: 'black', opacity: 2.5 },\n          \n          spiderfyLinear: false,\n          spiderfyLinearDistance: 30,\n          spiderfyLinearSeparation: 45,\n        }).addTo(self.map)\n\n\n        self.layer.clusterInfo = L.layerGroup().addTo(self.map)\n        self.layer.clusterInfo.name$ = 'clusterInfo'\n\n        \n        self.layer.asset.on('clusterclick', mev=>{\n          let layer = mev.layer\n          let {xco, yco} = convert_latlng(mev.latlng)\n          \n          let assetlist = layer.getAllChildMarkers().map(marker=>{\n            return self.data.assetMap[marker.assetID]\n          })\n\n          // console.log('CLUSTER-CLICK', assetlist)\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            event: 'clusterclick',\n            // xco,\n            // yco,\n            assetlist,\n          })\n\n\n          setTimeout(()=>{\n            self.closeAssetInfo()\n\n            let elem = $('#plantquest-assetmap-assetcluster')\n            if(null == elem) return;\n\n            let div = D.createElement('div')\n            div.appendChild(elem)\n            elem.style.display='block'\n            \n            let clusterInfo = self.current.clusterInfo\n            if(clusterInfo) {\n              clusterInfo.remove()\n            }\n            \n            clusterInfo = self.current.clusterInfo = L.marker(\n              c_asset_coords({x: xco+1, y: yco+20 }),\n              {\n                zIndexOffset: 1000,\n                icon: L.divIcon(\n                  {\n                    className: 'plantquest-assetmap-asset-cluster',\n                    html: div\n                  }),\n              }\n            )\n        \n            // TODO: parse out from the css\n            // clusterInfo.setOpacity(0.7)\n        \n            clusterInfo.addTo(self.layer.clusterInfo)\n\n            // let clusterInfo = new L.DivOverlay(\n            //   {\n            //     offset: [10,10],\n            //   }\n            // )\n\n            // clusterInfo.setContent(html)\n            \n            // clusterInfo.addTo(self.layer.asset)\n            \n          }, 11)\n        })\n\n        \n        self.map.on('layeradd', event=> { // zoom-in\n          let layer = event.layer // , circle, latlng, index, asset, arr, assetName\n\n\t  if(layer instanceof L.Marker && !(layer instanceof L.MarkerCluster)){\n\t    let assetCurrent = self.current.asset[layer.assetID]\n            if(null == assetCurrent) return;\n\n            let infobox = assetCurrent.infobox\n\t    if(assetCurrent) {\n\t      // console.error('layeradd: ', assetCurrent)\n\t      // setTimeout(()=>{\n\t        \n                let lem = assetCurrent.label && assetCurrent.label.getElement()\n                if(null != lem) {\n                  lem.style.display = infobox ? null : 'none'\n                  lem.style.width = ''\n                  lem.style.height = ''\n                  lem.style.fontSize = ''\n                }\n                assetCurrent.poly.addTo(self.layer.circles)\n                \n                \n                // state: asset blink\n                assetCurrent.blinkId = setInterval(function blink() {\n                  if(assetCurrent.poly) {\n                    if(assetCurrent.blink) {\n                      if(true === assetCurrent.blinkState) {\n                        assetCurrent.poly.addTo(self.layer.circles)\n                        assetCurrent.blinkState = false\n                      }\n                      else {\n                        assetCurrent.poly.remove(self.layer.circles)\n                        assetCurrent.blinkState = true\n                      }\n                    }\n                  }\n                }, self.config.mapInterval)\n                \n\t      //}, 11)\n\t      \n\t    }\n\t  }\n          \n        })\n        \n        self.map.on('layerremove', event=> { // zoom-in\n          let layer = event.layer // , circle, latlng, index, asset, arr, assetName\n\n\t  if(layer instanceof L.Marker && !(layer instanceof L.MarkerCluster)){\n\t    \n\t    let assetCurrent = self.current.asset[layer.assetID]\n\t    \n\t    if(assetCurrent) {\n\t      // console.log('layerremove: ', assetCurrent)\n\t      // setTimeout(()=>{\n\t        if(assetCurrent.poly) {\n\t          assetCurrent.poly.remove()\n\t        }\n\t        \n\t        if(assetCurrent.blinkId) {\n\t          clearInterval(assetCurrent.blinkId)\n\t        }\n                \n\t      //}, 11)\n\t    }\n\t  }\n          \n        })\n        \n      }\n\n      // No clustering\n      else {\n        self.layer.asset = L.layerGroup().addTo(self.map)\n      }\n\n      \n      \n      // TODO: move to generate\n      function generate_labels() {\n        self.poly_labels = self.poly_labels || {}\n\n        for (let room of self.data.rooms) {\n          let poly_labels = self.poly_labels[room.map] = self.poly_labels[room.map] || []\n\n\n          if (self.data.roomMap[room.room] && room.area === '1') {\n            // console.log(room.area)\n\n            let place;\n            // place = c_asset_coords({x: room.xco, y: room.yco}\n            // console.log( ) )\n\n            let room_poly = convertRoomPoly(self.config.mapImg, room.poly)\n\n\n            let poly = L.polygon(\n              room_poly, {\n                color: 'transparent',\n                pane: 'labels',\n              })\n\n            poly.name$ = 'ROOM:'+room.room\n\n            // Create the tooltip with the initial content\n            var tooltip = L.tooltip({\n              permanent: true,\n              direction: 'center',\n\n              // direction: 'sticky',\n              opacity: 1,\n              className: 'polygon-labels',\n\n            })\n\n            // Bind the tooltip to the polygon\n            poly.bindTooltip(tooltip);\n            let _c = poly.getBounds().getCenter()\n\n            tooltip.setContent(`<div class=\"leaflet-zoom-animted\"> ${room.room} </div>`);\n            /*\n                          setTimeout(() => {\n                            const label = L.marker(place, {\n                              icon: L.divIcon({\n                                // iconSize: [90, 30], // default size\n                                className: 'polygon-labels',\n                                html: `<div> ${room.room} </div>`\n                              })\n                            })\n                            // .addTo(self.map);\n\n                          }, 11)\n\n            */\n            // poly.addTo(self.map)\n\n            poly_labels.push(poly)\n\n          }\n\n\n        }\n\n      }\n      generate_labels()\n      \n      \n      // Define a custom control\n      function createDebugLog(content) {\n        let debugLog = L.Control.extend({\n          options: {\n            position: 'topleft',\n          },\n\n          onAdd: function (map) {\n            let container = L.DomUtil.create('div', 'control-panel')\n\n\n            let _div = document.createElement('div')\n    \n            _div.textContent = content\n            container.appendChild(_div)\n    \n    \n            L.DomEvent.disableClickPropagation(container)\n            L.DomEvent.disableScrollPropagation(container)\n\n            return container\n          }\n        })\n        return new debugLog()\n      }\n        \n      if(self.config.debugClick) {\n        self.map.on('click', (mev)=>{\n          let {xco, yco} = convert_latlng(mev.latlng)\n            \n          let content = ''\n\t  if(self.leaflet.debugLog) {\n\t    self.leaflet.debugLog.remove()\n\t    self.leaflet.debugLog = null\n\t  }\n\t  let asset_data = {}\n\t  asset_data.xco = xco\n\t  asset_data.yco = yco\n\t  content = JSON.stringify(asset_data)\n\t    \n\t  self.leaflet.debugLog = createDebugLog(content)\n\t  // Add the custom control to the map\n          self.map.addControl(self.leaflet.debugLog)\n            \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            event: 'click',\n            meta: asset_data,\n          })\n            \n        })\n      }\n      \n      if(W.PLANTQUEST_ASSETMAP_DEBUG.show_coords) {\n      \n        self.listen((msg) => {\n\t  if(msg.show == 'asset') {\n\t    let { asset } = msg\n\t    let content = ''\n\t    if(self.leaflet.debugLog) {\n\t      self.leaflet.debugLog.remove()\n\t      self.leaflet.debugLog = null\n\t    }\n\t    if(asset) {\n\t      let asset_data = {}\n\t      asset_data.tag = asset.tag\n\t      asset_data.id = asset.id\n\t      asset_data.xco = asset.xco\n\t      asset_data.yco = asset.yco\n\t      content = JSON.stringify(asset_data)\n\t    }\n\t    self.leaflet.debugLog = createDebugLog(content)\n\t    // Add the custom control to the map\n            self.map.addControl(self.leaflet.debugLog)\n\t  }\n\t  else if(msg.event == 'click') {\n\t    let meta = msg.meta\n\t      \n\t    let asset_data = {}\n\t    let content = ''\n\t    if(self.leaflet.debugLog) {\n\t      self.leaflet.debugLog.remove()\n\t      self.leaflet.debugLog = null\n\t    }\n\t    asset_data.xco = meta.xco\n\t    asset_data.yco = meta.yco\n\t    content = JSON.stringify(asset_data)\n\t    self.leaflet.debugLog = createDebugLog(content)\n            self.map.addControl(self.leaflet.debugLog)\n\t      \n\t  }\n\t  else {\n\t    if(self.leaflet.debugLog) {\n\t      self.leaflet.debugLog.remove()\n\t      self.leaflet.debugLog = null\n\t    }\n\t    self.leaflet.debugLog = createDebugLog('DEBUG LOG')\n\t      \n            self.map.addControl(self.leaflet.debugLog)\n\t  }\n\t  \n\t})\n      }\n      \n      if(self.config.showAllAssets) {\n        setTimeout( () => {\n          self.send({\n            srv:'plantquest',\n            part:'assetmap',\n            show: 'asset',\n            asset: null,\n          })\n        }, 11)\n      }\n       \n      self.map.on('mousemove', (mev)=>{\n        let {xco, yco} = convert_latlng(mev.latlng)\n        self.loc.x = xco\n        self.loc.y = yco\n        // console.log(self.loc.x, self.loc.y)\n      })\n      \n\n      // setInterval(self.checkRooms, self.config.mapInterval)\n\n\n      let levelActions = []\n      \n      self.data.levels.forEach((level,index)=>{\n        levelActions.push(\n          L.Toolbar2.Action.extend({\n            options: {\n              toolbarIcon: {\n                html: level,\n              }\n            },\n            \n            addHooks: function () {\n              self.showMap(index)\n            }\n          })\n        )\n      })\n\n      self.config.plants.forEach((plant,index)=>{\n        levelActions.push(\n          L.Toolbar2.Action.extend({\n            options: {\n              toolbarIcon: {\n                html: plant.name,\n              }\n            },\n            \n            addHooks: function () {\n              self.showMap(index)\n            }\n          })\n        )\n      })\n\n      self.map.addLayer(new L.Toolbar2.Control({\n        actions: levelActions,\n        position: 'topright',\n      }))\n\n        \n      /*\n      // new L.Toolbar2.Control({\n      //   actions: levelActions\n      // }).addTo(self.map)\n\n      let plantActions = []\n      self.config.plants.forEach((plant,index)=>{\n        plantActions.push(\n          L.Toolbar2.Action.extend({\n            options: {\n              toolbarIcon: {\n                html: plant.name,\n              }\n            },\n            \n            addHooks: function () {\n              self.showMap(index)\n            }\n          })\n        )\n      })\n      \n      // new L.Toolbar2.Control({\n      //   position: 'bottomleft',\n      //   actions: plantActions,\n      // }).addTo(self.map)\n\n      self.map.addLayer(\n        new L.Toolbar2.Control({\n          position: 'bottomleft',\n          actions: plantActions,\n        }).addTo(self.map)\n        )\n        */\n    }\n\n\n    self.zoomStartRender = function() {\n      let zoom = self.map.getZoom()\n      if(null == zoom) return;\n      // console.log('start', zoom)\n      \n      \n\n        \n        \n      if(zoom != 4) {\n      /*\n        if(self.polys) {\n          for(let poly of self.polys) {\n            poly.remove()\n          }\n        \n        }\n        */\n        \n      }\n\n    }\n\n\n    self.zoomEndRender = function() {\n      let zoom = self.map.getZoom()\n      if (null == zoom) return;\n      // console.log('end: ', zoom)\n\n      let pos = (1+self.loc.map)\n      \n      self.poly_labels = self.poly_labels || {}\n      \n      let labels = self.poly_labels[pos] || []\n      self.prev_labels = self.prev_labels || []\n      \n      \n      let labelZoomLevel =\n          null == self.config.label.zoom ? self.config.mapMaxZoom : \n          self.config.label.zoom\n      \n      // if (zoom >= 6) {\n      if (zoom >= labelZoomLevel) {\n        for(let label of self.prev_labels) {\n          label.remove()\n        }\n        \n        \n        for(let label of labels) {\n          label.remove()\n          // label.addTo(self.map)\n          label.addTo(self.layer.label)\n        }\n          \n        self.setLabel = true\n        self.prev_labels = labels\n\n      } \n      else {\n        for(let label of self.prev_labels) {\n          label.remove()\n        }\n        \n        for (let label of labels) {\n          label.remove()\n        }\n\n        self.setLabel = false\n\n     }\n      \n\n      // self.layer.label.bringToBack()\n      \n      /*\n      if(self.config.assetFontHideZoom < zoom) {\n        let assetFontSize = self.config.assetFontScaleRoom +\n          (zoom * self.config.assetFontScaleZoom)        \n\n        let assetFontSizePts = assetFontSize+'pt'\n      \n        $All('.plantquest-assetmap-asset-label-green')\n          .forEach(label => {\n            label.style.display='block'\n          })\n        $All('.plantquest-assetmap-asset-label-red')\n          .forEach(label => {\n            label.style.display='block'\n          })\n      }\n      else {\n        $All('.plantquest-assetmap-asset-label-green')\n          .forEach(label => {\n            label.style.display='none'\n          })\n        $All('.plantquest-assetmap-asset-label-red')\n          .forEach(label => {\n            label.style.display='none'\n          })\n      }\n      */\n    }\n    \n    \n    self.checkRooms = function() {\n      let xco = self.loc.x\n      let yco = convert_poly_y(self.config.mapImg, self.loc.y)\n      \n      let rooms = Object.values(self.data.rooms)\n\n      for(let room of rooms) {\n        if((1+self.loc.map) != room.map) {\n          continue\n        }\n        \n        let alarmState = self.current.room[room.room] ?\n            self.current.room[room.room].alarm : null\n\n        let inside = room.poly && pointInPolygon([yco,xco], room.poly)\n        let alreadyShown = room === self.loc.room || room === self.loc.chosen.room\n        let drawRoom = inside && !alreadyShown && 'red' !== alarmState\n        \n        \n        if(!drawRoom && !inside && self.loc.room === room) {\n          if(self.loc.poly) {\n            self.loc.poly.remove(self.layer.room)\n            self.loc.room = null\n          }\n        }\n        else if(drawRoom) {\n          if(self.loc.poly) {\n            self.loc.poly.remove(self.layer.room)\n            self.loc.room = null\n          }\n          \n          try {\n            let roomState = self.current.room[room.room] ||\n                (self.current.room[room.room]={alarm:'neutral'})\n            let room_poly = convertRoomPoly(self.config.mapImg, room.poly)\n\n            self.loc.room = room\n            self.loc.alarmState = alarmState\n            \n\n            self.loc.poly = L.polygon(\n              room_poly, {\n                // color: self.resolveRoomColor(roomState.alarm,'lo')\n                color: self.config.room.color\n              })\n\n            self.loc.poly.on('click', ()=>{\n              // console.log('SELECT ROOM', room)\n              self.selectRoom(room.room)\n            })\n            \n            self.loc.poly.addTo(self.layer.room)\n          }\n          catch(e) {\n            self.log('ERROR','map','1020', e.message, e)\n          }\n        }\n      }\n\n\n    }        \n\n\n    self.selectRoom = function(roomId,opts) {\n      opts = opts || {}\n      try {\n        let room = self.data.roomMap[roomId]\n        let isChosen = self.loc.chosen.room && roomId === self.loc.chosen.room.room\n        \n        if(null == self.data.roomMap[roomId] || isChosen) {\n          self.focusRoom(self.loc.chosen.room)\n          return\n        }\n\n        self.log('selectRoom', roomId, room)\n\n        // self.showMap(parseInt(room.map)-1)\n        \n        let roomState = self.current.room[room.room] ||\n            (self.current.room[room.room]={alarm:'neutral'})\n\n        if(self.loc.poly) {\n          self.loc.poly.remove(self.layer.room)\n          self.loc.poly = null\n        }\n        self.loc.room = null\n\n        if(self.loc.chosen.poly && room !== self.loc.chosen.room) {\n          let prevRoom = self.loc.chosen.room\n          let prevRoomState = self.current.room[prevRoom.room] ||\n              (self.current.room[prevRoom.room]={alarm:'neutral'})\n\n          // if('red'===prevRoomState.alarm) {\n          //   self.loc.chosen.poly.setStyle({\n          //     color: self.resolveRoomColor(prevRoomState.alarm,'lo')\n          //   })\n          //   self.loc.stateShown[prevRoom.room].poly = self.loc.chosen.poly\n          // }\n          // else {\n            self.loc.chosen.poly.remove(self.layer.room)\n            self.loc.chosen.poly = null\n        // }\n        }\n\n        if(self.loc.popup) {\n          self.loc.popup.remove(self.map)\n          self.loc.popop = null\n        }\n\n        self.loc.chosen.room = room\n\n\n        // if('red' === roomState.alarm) {\n        //   let stateShown = self.loc.stateShown[room.room] ||\n        //       (self.loc.stateShown[room.room]= {})\n        //   if(stateShown.poly) {\n        //     stateShown.poly.setStyle({\n        //       color: self.resolveRoomColor(roomState.alarm,'hi')\n        //     })\n        //     self.loc.chosen.poly = stateShown.poly\n        //   }\n        // }\n        // else {\n          let room_poly = convertRoomPoly(self.config.mapImg, room.poly)\n          \n          self.loc.chosen.poly = L.polygon(\n            room_poly, {\n              // color: self.resolveRoomColor(roomState.alarm,'hi')\n              color: self.config.room.color\n          })\n          self.loc.chosen.poly.on('click', ()=>self.selectRoom(room.room))\n          \n          self.loc.chosen.poly.addTo(self.layer.room)\n      // }\n\n        let roomlatlng = self.focusRoom(room)\n        \n        // convert for popup\n        let roompos_y = convert_poly_y(self.config.mapImg, roomlatlng[0])\n        let roompos_x = roomlatlng[1]\n        let roompos = c_asset_coords({y: roompos_y-4, x: roompos_x+5 } )\n               \n        // map focus on room selection\n        self.loc.popup = L.popup({\n          autoClose: false,\n          closeOnClick: false,\n        })\n          .setLatLng(roompos)\n          .setContent(self.roomPopup(self.loc.chosen.room))\n          .openOn(self.map)\n        \n        // self.map.setView(roompos,\n                         // self.map.getZoom())\n                         \n\n        self.showRoomAssets(room.room)\n        self.clearRoomAssets(room.room)\n        // self.zoomEndRender()\n        \n        if(!opts.mute) {\n          self.click({select:'room', room:self.loc.chosen.room.room})\n        }\n      }\n      catch(e) {\n        self.log('ERROR','selectRoom','1010', roomId, e.message, e)\n      }\n    }\n\n\n    self.unselectRoom = function() {\n      let prevRoom = self.loc.chosen.room\n      if(prevRoom) {\n        self.loc.chosen.room = null\n        let prevRoomState = self.current.room[prevRoom.room] ||\n            (self.current.room[prevRoom.room]={alarm:'neutral'})\n      \n        if('red'===prevRoomState.alarm) {\n          self.loc.chosen.poly.setStyle({\n            color: self.resolveRoomColor(prevRoomState.alarm,'lo')\n          })\n          self.loc.stateShown[prevRoom.room].poly = self.loc.chosen.poly\n        }\n        else {\n          self.loc.chosen.poly.remove(self.layer.room)\n        }\n\n        self.loc.chosen.poly = null\n\n        if(self.loc.popup) {\n          self.loc.popup.remove(self.map)\n          self.loc.popop = null\n        }\n      }\n    }\n\n    \n    self.focusRoom = function(room) {\n      if(null == room) return;\n      \n      let roomlatlng = [0,0]\n      for(let point of room.poly) {\n        if(point[0] > roomlatlng[0]) {\n          roomlatlng[0] = point[0]\n          roomlatlng[1] = point[1]\n        }\n      }\n\n      // let roompos = [roomlatlng[0],roomlatlng[1]-30]\n      \n      let roompos_y = convert_poly_y(self.config.mapImg, roomlatlng[0])\n      let roompos_x = roomlatlng[1]\n      let roompos = c_asset_coords({y: roompos_y, x: roompos_x-30 } )\n      // self.map.setView(roompos, self.config.mapRoomFocusZoom)\n      self.map.setView(roompos,\n                        self.config.mapRoomFocusZoom)\n                        \n      self.zoomEndRender()\n      \n      return roomlatlng\n    }\n\n    \n    self.showRoom = function(room, stateName) {\n      self.log('showRoom', room, stateName)\n\n      \n      stateName = stateName || assetCurrent.stateName || (Object.keys(self.config.states)[0])\n      let stateDef = self.config.states[stateName]\n\n      room = 'string' === typeof room ? self.data.roomMap[room] : room\n      \n      try {\n        stateDef = self.alertRoomState(room.room, stateDef)\n        \n        let roomCurrent =\n            self.current.room[room.room] ||\n            (self.current.room[room.room]={})\n\n        roomCurrent.stateDef = stateDef\n\n        let stateShown = self.loc.stateShown[room.room] ||\n            (self.loc.stateShown[room.room]= {})\n\n        if(room === self.loc.chosen.room) {\n          if(self.loc.chosen.poly) {\n            self.loc.chosen.poly.setStyle({\n              // color: self.resolveRoomColor(roomCurrent.stateDef,'hi')\n              color: self.config.room.color\n            })\n          }\n        }\n        else {\n          if(stateShown.poly) {\n            stateShown.poly.remove(self.layer.room)\n            stateShown.poly = null\n          }\n            \n          // if('red' === alarm) {\n          //   stateShown.poly = L.polygon(\n          //     room.poly, {\n          //       color: self.resolveRoomColor(roomCurrent.stateDef,'lo')\n          //     })\n          //   stateShown.poly.addTo(self.layer.room)\n          //   stateShown.poly.on('click', ()=>self.selectRoom(room.room))\n          // }\n        }\n        \n      }\n      catch(e) {\n        self.log('ERROR','map','showRoom','1040', e.message, e)\n      }\n    }\n\n    \n    // Room state is set to highest priority (by order of definition in config.states) alert state\n    self.alertRoomState = function(roomID, newStateDef) {\n      let actualStateDef = newStateDef\n      let newPriority = Object.keys(self.config.states).indexOf(newStateDef.stateName)\n      \n      let assets = (self.data.deps.pc.room[roomID] ?\n                    self.data.deps.pc.room[roomID].asset : []) || []\n      for(let assetID of assets) {\n        let assetState = self.current.asset[assetID]\n        if(assetState && assetState.stateName) {\n          let stateDef = self.config.states[assetState.stateName]\n          if('alert' === stateDef.marker) {\n            let priority = Object.keys(self.config.states).indexOf(assetState.stateName)\n            if(newPriority < priority) {\n              actualStateDef = stateDef\n            }\n          }\n        }\n      }\n\n      return actualStateDef\n    }\n    \n\n    self.closeAssetInfo = function() {\n      if(self.config.infobox.single) {\n        Object.values(self.current.assetInfoShown).map(assetDesc=>{\n          let elem = assetDesc.label && assetDesc.label.getElement()\n          if(elem) {\n            elem.style.display = 'none'\n          }\n        })\n      }\n    }\n    \n    \n    self.showAsset = function(assetID, stateName, hide, blink, showRoom, infobox) {\n      self.closeAssetInfo()\n\n      let assetCurrent =\n          self.current.asset[assetID] || (self.current.asset[assetID]={})\n\n      stateName =\n        stateName || assetCurrent.stateName || (Object.keys(self.config.states)[0])\n\n      let stateDef = self.config.states[stateName]\n      let assetProps = self.data.assetMap[assetID]\n      \n      assetCurrent.infobox = infobox == null ? true : !!infobox\n      \n      self.log('showAsset', assetID, stateName,\n               stateDef, 'hide', hide, 'blink', blink, assetProps)\n      \n      if(null == assetProps) {\n        return\n      }\n      \n      if(assetCurrent.poly) {\n        assetCurrent.poly.remove(self.layer.asset)\n        assetCurrent.poly = null\n      }\n\n      if(assetCurrent.label) {\n        self.layer.asset.removeLayer(assetCurrent.label)\n        assetCurrent.label = null\n      }\n      \n      if(showRoom) {\n        self.showRoom(assetProps.room, stateName)\n      \n        // Only draw polys if room is chosen or not hiding\n        if(hide ||\n          (null == self.loc.chosen.room ||\n            assetProps.room !== self.loc.chosen.room.room))\n          {\n            return\n          }\n      }\n      \n      if(hide) {\n        delete self.current.assetInfoShown[assetID]\n        return\n      }\n      else if(infobox) {\n        self.current.assetInfoShown[assetID] = assetCurrent\n      }\n\n      let clusterInfo = self.current.clusterInfo\n      if(clusterInfo) {\n        let elem = $('#plantquest-assetmap-assetcluster')\n        elem.style.display = 'none'\n        $('body').appendChild(elem)\n        clusterInfo.remove()\n      }\n\n      \n      let assetPoint = [\n        assetProps.yco,\n        assetProps.xco,\n      ]\n      let ax = assetPoint[1]\n      let ay = assetPoint[0]\n      \n      assetCurrent.stateName = stateName\n      let color = stateDef.color\n      \n      let ay_poly = convert_poly_y(self.config.mapImg, ay)\n      let room_poly = convertRoomPoly(self.config.mapImg, [\n          [ay_poly+10,ax],\n          [ay_poly-10,ax+10],\n          [ay_poly-10,ax-10],\n      ])\n      \n      if('alert' === stateDef.marker) {\n        assetCurrent.poly = L.polygon(room_poly, {\n          color: color,\n        })\n      }\n      else {\n        assetCurrent.poly =\n          L.circle(\n            c_asset_coords({x: ax, y: ay}), {\n              radius: 0.2,\n              color: color,\n              weight: 2,\n            })\n          .on('click', ()=>{\n            console.log('ASSET-CLICK', assetCurrent)\n            self.emit({\n              srv: 'plantquest',\n              part: 'assetmap',\n              event: 'click',\n              on: 'asset',\n              asset: assetProps,\n            })\n          })\n      }\n\n      \n      assetCurrent.blink = null == blink ? false : blink\n\n        setTimeout(()=>{\n          if(null != assetCurrent.label) {\n            return\n          }\n\n          let elem = $('#plantquest-assetmap-assetinfo')\n          if(null == elem) return;\n\n          // TODO: create with unique id in order to swap in\n          let div = elem.innerHTML\n          \n          // let div = D.createElement('div')\n          // div.appendChild(elem)\n          // elem.style.display='block'\n\n          \n          assetCurrent.label = L.marker(\n            c_asset_coords({x: ax+1, y: ay+20 }),\n            {\n              zIndexOffset: 1000,\n              icon: L.divIcon(\n                {\n                  className: 'plantquest-assetmap-asset-label '+\n                    'plantquest-assetmap-asset-state-'+stateName,\n                  html: div\n                }),\n            }\n          )\n          \n          // TODO: parse out from the css\n          assetCurrent.label.setOpacity(0.7)\n          \n          assetCurrent.label.assetID = assetID\n          assetCurrent.label.addTo(self.layer.asset)\n          \n          self.zoomEndRender()\n        }, 11)\n    }\n\n    \n    self.clearRoomAssets = function(roomID) {\n      for(let assetID in self.current.asset) {\n        let assetCurrent = self.current.asset[assetID]\n        if(self.data.deps.cp.asset[assetID].room !== roomID) {\n          if(assetCurrent.poly) {\n            assetCurrent.poly.remove(self.layer.asset)\n          }\n          if(assetCurrent.label) {\n            assetCurrent.label.remove(self.layer.asset)\n          }\n        }\n      }\n    }\n\n    \n    self.showRoomAssets = function(roomID) {\n      let assets = (self.data.deps.pc.room[roomID] ?\n                    self.data.deps.pc.room[roomID].asset : []) || []\n\n      for(let assetID of assets) {\n        let assetCurrent = self.current.asset[assetID]\n        if(assetCurrent && assetCurrent.alarm) {\n          self.showAsset(assetID, assetCurrent.alarm)\n        }\n      }\n    }\n\n    self.getUrl = function(mapIndex) {\n      return self.config.tilesEndPoint + '/' + mapIndex + '/{z}/{x}/{y}.png'\n    },\n    \n    self.createTile = function(mapIndex) {\n      let tileLyr = \n        L.tileLayer(self.getUrl(mapIndex), {\n          // noWrap: true,\n          // maxNativeZoom: rc.zoomLevel(),\n          bounds: self.rc.getMaxBounds(),\n          minZoom: self.config.mapMinZoom,\n          maxZoom: self.config.mapMaxZoom,\n        })\n      return tileLyr\n    },\n    \n    self.showMap = function(mapIndex) {\n      self.log('showMap', mapIndex, self.loc)\n      \n      if(mapIndex !== self.loc.map) {\n        if(self.leaflet.maptile) {\n          self.leaflet.maptile.remove(self.map)\n        }\n        // let mapurl = self.config.map[mapIndex]\n        // let bounds = [[0, 0], [...self.config.mapBounds]]\n        self.leaflet.maptile = self.createTile(mapIndex+1)\n        // self.leaflet.mapimg = L.imageOverlay(mapurl, bounds)\n        self.leaflet.maptile.addTo(self.map)\n        self.loc.map = mapIndex\n        \n        // render labels\n        self.zoomEndRender()\n\n\t\n\n        self.unselectRoom()\n\n        if(self.loc.poly) {\n          self.loc.poly.remove(self.layer.room)\n          self.loc.room = null\n        }\n        \n        self.emit({\n          srv:'plantquest',\n          part:'assetmap',\n          show:'map',\n          map: self.loc.map,\n          level: self.data.levels[self.loc.map],\n        })\n      }\n    }\n\n    \n    self.resolveRoomColor = function(stateDef, hilo) {\n      return 'hi' === hilo ? stateDef.color : self.config.room.color\n    }\n    \n\n    self.roomPopup = function(room, msg) {\n      let html = []\n\n      html.push(\n        '<h2>',\n        room.room,\n        '</h2>'\n      )\n\n      return html.join('\\n')\n    }\n\n    \n    self.getRoomAssets = function(roomID) {\n      let assets = []\n      let roomMap = self.data.deps.pc.room\n      let roomEntry = roomMap[roomID]\n      assets = roomEntry && roomEntry.asset ? roomEntry.asset.map(a=>({\n        asset: a\n      })) : assets\n      return assets\n    }\n\n\n    self.getSeneca = async function() {\n      if(null != self.seneca) {\n        return self.seneca\n      }\n\n      let endpoint = (msg) => {\n        let suffix = '/api/web' + '/public/' + msg.on\n        let origin = self.config.endpoint // 'http://127.0.0.1:8888'\n        let url = origin + suffix\n        return url\n      }\n  \n      let seneca = new Seneca({\n        log: { logger: 'flat', level: 'warn' },\n        plugin: {\n          browser: {\n            endpoint,\n            headers: {\n              'Authorization': 'Bearer ' + self.config.apikey,\n\t    },\n          }\n        },\n        timeout: 44444,\n      })\n      \n      seneca\n        .test()\n        .use(SenecaEntity)\n        .ready(async function() {\n          const seneca = this\n          // console.log('seneca ready')\n        })\n            \n      // await seneca.ready()\n      \n      await seneca.client({\n        type: 'browser',\n        pin: [\n          \n          'aim:web',\n          \n          'aim:web,on:assetmap,get:info',\n\n          'aim:web,on:assetmap,list:asset',\n          'aim:web,on:assetmap,load:asset',\n          'aim:web,on:assetmap,save:asset',\n          'aim:web,on:assetmap,remove:asset',\n\n          'aim:web,on:assetmap,list:room',\n          'aim:web,on:assetmap,load:room',\n          'aim:web,on:assetmap,save:room',\n          'aim:web,on:assetmap,remove:room',\n\n          'aim:web,on:assetmap,list:building',\n          'aim:web,on:assetmap,load:building',\n          'aim:web,on:assetmap,save:building',\n          'aim:web,on:assetmap,remove:building',\n        ]\n      })\n\n      seneca\n        .fix('srv:plantquest,part:assetmap')\n\n        .message('remove:asset', async function removeAsset(msg) {\n          let { id } = msg\n          let result = await this.post('aim:web,on:assetmap,remove:asset', { id } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            remove:'asset',\n            asset: id,\n          })\n          \n          return result\n        })\n      \n        .message('remove:room', async function removeRoom(msg) {\n          let { id } = msg\n          let result = await this.post('aim:web,on:assetmap,remove: room', { id, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            remove:'room',\n            room: id,\n          })\n          \n          return result\n        })\n      \n        .message('remove:building', async function(msg) {\n          let { id } = msg\n          let result = await this.post('aim:web,on:assetmap,remove:building', { id, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            remove:'building',\n            building: id,\n          })\n          \n          return result\n        })\n      \n        .message('save:asset', async function(msg) {\n          let { asset } = msg\n          asset = asset || {}\n          asset = { ...asset, ...{\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          } }\n          asset =\n            await this.post('aim:web,on:assetmap,save:asset', { asset: {...asset}, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            save:'asset',\n            asset: asset.asset,\n          })\n          \n          return asset\n        })\n\n        .message('save:room', async function(msg) {\n          let { room } = msg\n          room = room || {}\n          room = { ...room, ...{\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          } }\n          room =\n            await this.post('aim:web,on:assetmap,save:room', { room: {...room}, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            save:'room',\n            room: room.room,\n          })\n          \n          return room\n        })\n      \n        .message('save:building', async function(msg) {\n          let { building } = msg\n          building = building || {}\n          building = { ...building, ...{\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          } }\n          building =\n            await this.post('aim:web,on:assetmap,save:building',\n                            { building: {...building}, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            save:'building',\n            building: building.building,\n          })\n          \n          return building\n        })\n      \n        .message('load:asset', async function(msg) {\n          const { id } = msg\n          let asset = await this.post('aim:web,on:assetmap,load:asset', { id, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            load:'asset',\n            asset: asset.asset,\n          })\n          \n          return asset\n        })\n      \n        .message('load:room', async function(msg) {\n          const { id } = msg\n          let room = await this.post('aim:web,on:assetmap,load:room', { id, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            load:'room',\n            room: room.room,\n          })\n          \n          return room\n        })\n      \n        .message('load:building', async function(msg) {\n          const { id } = msg\n          let building =\n              await this.post('aim:web,on:assetmap,load:building', { id, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            load:'building',\n            building: building.building,\n          })\n          \n          return building\n        })\n      \n        .message('list:asset', async function(msg) {\n          let { query } = msg\n          query = query || {\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          }\n          let assets = await this.post('aim:web,on:assetmap,list:asset', { query, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            list:'asset',\n            assets: assets.assets,\n          })\n          \n          return assets\n        })\n\n        .message('list:room', async function(msg) {\n          let { query } = msg\n          query = query || {\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          }\n          let rooms = await this.post('aim:web,on:assetmap,list:room', { query, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            list:'room',\n            rooms: rooms.rooms,\n          })\n          \n          return rooms\n        })\n\n        .message('list:building', async function(msg) {\n          let { query } = msg\n          query = query || {\n            project_id: self.config.project_id,\n            plant_id: self.config.plant_id,\n            stage: self.config.stage,\n          }\n          let buildings =\n              await this.post('aim:web,on:assetmap,list:building', { query, } )\n          \n          self.emit({\n            srv:'plantquest',\n            part:'assetmap',\n            list:'building',\n            buildings: buildings.buildings,\n          })\n          \n          return buildings\n        })\n      \n        .message('show:map', async function(msg) {\n          // console.error(\"cmd map msgg: \", msg)\n          self.showMap(msg.map)\n        })\n      \n        .message('show:room', async function(msg) {\n          let room = self.data.roomMap[msg.room]\n          \n          if(room) {\n            if(msg.assets) {\n              if(msg.assets) {\n                for(let asset of msg.assets) {\n                  self.showAsset(asset.asset, asset.state)\n                }\n              }\n            }\n\n            if(msg.focus) {\n              self.selectRoom(room.room, { mute:true })\n            }\n          }\n          else {\n            self.log('ERROR', 'send', 'room', 'unknown-room', msg)\n          }\n          \n        })\n      \n        .message('show:plant', async function(msg) {\n          // console.error(\"cmd plant msgg: \", msg)\n          self.showMap(msg.plant)\n        })\n      \n        .message('show:floor', async function(msg) {\n          // console.error(\"cmd floor msgg: \", msg)\n          \n          self.showMap(msg.map)\n          self.clearRoomAssets()\n          self.unselectRoom()\n          self.map.setView(self.config.mapStart, self.config.mapStartZoom)\n          \n        })\n\n        .message('show:asset', async function(msg) {\n          assetShow(msg)\n        })\n\n        .message('hide:asset', async function(msg) {\n          assetShow(msg)\n        })\n\n        .message('relate:room-asset', async function(msg) {\n          self.emit({\n            srv: 'plantquest',\n            part: 'assetmap',\n            relate: 'room-asset',\n            relation: clone(self.data.deps.pc.room)\n          })\n        })\n\n        .message('srv:plantquest,part:assetmap', async function(msg) {})\n\n      await seneca.ready()\n\n      function assetShow(msg) {\n        if(Array.isArray(msg.asset) || msg.asset === null) {\n          msg.asset = msg.asset || Object.keys(self.data.assetMap)\n          \n          for(let assetID of msg.asset) {\n            let stateName = msg.state\n            let assetData = self.data.assetMap[assetID]\n            \n            if(assetData == null) {\n              self.log('ERROR', 'send', 'asset', 'unknown-asset', assetID)\n              continue\n            }\n            \n            if(assetData.xco == null || assetData.yco == null) {\n              self.log('ERROR', 'send', 'asset', 'invalid-asset', assetData)\n              continue\n            }\n            \n            self.emit({\n              srv:'plantquest',\n              part:'assetmap',\n              show:'asset',\n              before:true,\n              asset: assetData,\n            })\n\n            let showInfoBox =\n                null == msg.infobox ? self.config.infobox.show : msg.infobox \n            \n            self.showAsset(assetData.id, stateName,\n                           'asset' === msg.hide, !!msg.blink, false, showInfoBox)\n          }\n        }\n        else { \n          let assetRoom = self.data.deps.cp.asset[msg.asset]\n          let assetData = self.data.assetMap[msg.asset]\n          let zoom = msg.zoom || self.config.mapMaxZoom\n          \n          if(assetRoom) {\n            self.emit({\n              srv:'plantquest',\n              part:'assetmap',\n              show:'asset',\n              before:true,\n              focus: !!msg.focus,\n              zoom: zoom,\n              asset: assetData,\n            })\n            let coords = c_asset_coords({x: assetData.xco, y: assetData.yco})\n            \n            \n            setTimeout(()=>{\n              if(!!msg.focus) {\n                self.map.setView(coords, zoom)\n              }\n            }, 55)\n            \n            let showInfoBox =\n                null == msg.infobox ? self.config.infobox.show : !!msg.infobox\n            \n            self.showAsset(\n              msg.asset,\n              msg.state,\n              'asset' === msg.hide, !!msg.blink, false, showInfoBox)\n          }\n          else {\n            self.log('ERROR', 'send', 'asset', 'unknown-asset', msg)\n          }\n        }\n      }\n\n      \n      return self.seneca = seneca\n    }\n    \n    return self\n  }\n\n  function buildContainer() {\n    let html = [\n      '<div id=\"plantquest-assetmap-map\" class=\"plantquest-assetmap-vis\"></div>',\n    ]      \n    return html.join('')\n  }\n  \n  function fixid(idstr) {\n    return idstr.replace(/[ \\t]/g, '-')\n  }\n  \n  function clear() {\n  }\n  \n  function clone(obj) {\n    if(null != obj && 'object' === typeof obj) {\n      return JSON.parse(JSON.stringify(obj))\n    }\n    return obj\n  }\n\n\n  // pointInPolygon\n  // The MIT License (MIT) Copyright (c) 2016 James Halliday\n  // See https://github.com/substack/point-in-polygon\n  \n  function pointInPolygon (point, vs, start, end) {\n    if (vs.length > 0 && Array.isArray(vs[0])) {\n      return pointInPolygonNested(point, vs, start, end)\n    } else {\n      return pointInPolygonFlat(point, vs, start, end)\n    }\n  }\n\n  function pointInPolygonFlat (point, vs, start, end) {\n    let x = point[0], y = point[1]\n    let inside = false\n    if (start === undefined) start = 0\n    if (end === undefined) end = vs.length\n    let len = (end-start)/2\n    for (let i = 0, j = len - 1; i < len; j = i++) {\n      let xi = vs[start+i*2+0], yi = vs[start+i*2+1]\n      let xj = vs[start+j*2+0], yj = vs[start+j*2+1]\n      let intersect = ((yi > y) !== (yj > y))\n          && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)\n      if (intersect) inside = !inside\n    }\n    return inside\n  }\n  \n  function pointInPolygonNested (point, vs, start, end) {\n    let x = point[0], y = point[1]\n    let inside = false\n    if (start === undefined) start = 0\n    if (end === undefined) end = vs.length\n    let len = end - start\n    for (let i = 0, j = len - 1; i < len; j = i++) {\n      let xi = vs[i+start][0], yi = vs[i+start][1]\n      let xj = vs[j+start][0], yj = vs[j+start][1]\n      let intersect = ((yi > y) !== (yj > y))\n          && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)\n      if (intersect) inside = !inside\n    }\n    return inside\n  }\n  \n  // utility functions\n  \n  // transform poly coords for tilesets\n  function convertRoomPoly(img, poly) {\n    let p = []\n    for(let part of poly) {\n      p.push( rc.unproject({ x: part[1], y: img[1] - part[0] }) )\n    }\n    return p\n  }\n  \n  function convert_latlng(latlng) {\n    let Lng = rc.project(latlng)\n    return { \n      xco: Math.floor(Lng.x),\n      yco: Math.floor(Lng.y)\n    }\n    \n  }\n  \n  function convert_poly_y(img, y) {\n    return img[1] - y\n  }\n  \n  function c_asset_coords({ x, y }) {\n    return rc.unproject({ x, y })\n  }\n\n  function make_parent_key(relate, asset) {\n    return relate.p.split(/~/g).map(pn => asset[pn]).join('~')\n  }\n\n  function make_parent_val(relate, asset) {\n    return relate.p.split(/~/g).reduce(((a, pn) => (a[pn] = asset[pn], a)), {})\n  }\n\n\n  function make_child_id(relate, asset) {\n    // let ccol = 'asset' === relate.c ? 'tag' : relate.c\n    return asset[relate.c]\n  }\n\n  function insert_child(arr, child) {\n    if(arr instanceof Array) {\n      for (let i = 0; i < arr.length; i++) {\n        // ( ('~'+arr[i]) == ('~'+child) )\n        if ( (arr[i]) === (child) ) {\n          return\n        } else if ( (arr[i]) > (child) ) {\n          arr.splice(i, 0, child)\n          return\n        }\n      }\n      arr.push(child)\n    }\n    else if(arr instanceof Set) {\n      arr.add(child)\n    }\n  }\n\n  function generate(collection) {\n    let ROOM_ATYPE = {\n      'Room/Area': 1,\n    }\n    \n    let deps = {\n      cp: {},\n      pc: {},\n    }\n\n    // Use a declarative data structure to define the relations we want.\n    let relate = [\n      { pc: true, p: 'room', c: 'asset', exclude: (asset) => ROOM_ATYPE[asset.atype] },\n      { pc: true, p: 'map',c: 'building' },\n      { pc: true, p: 'building', c: 'level' },\n      { pc: true, p: 'building', c: 'map' },\n      { pc: true, p: 'map~building', c: 'level' },\n      { pc: true, p: 'map~building~level', c: 'room',include: (asset) => ROOM_ATYPE[asset.atype] },\n      { pc: true, p: 'building~level', c: 'map' },\n      { pc: true, p: 'map~level',c: 'level', include: (asset) => asset.map },\n\n      { cp: true, p: 'map~building~level', c: 'room' },\n      { cp: true, p: 'room', c: 'asset', exclude: (asset) => ROOM_ATYPE[asset.atype] },\n    ]\n\n    let maps = []\n    let levels = []\n    let buildings = new Set()\n    \n    let assetMap = {}\n    let roomMap = {}\n    \n    Object.values(collection).forEach(assets => {\n    \n      assets.forEach(asset => {\n\n        // asset = { ...asset }\n      \n        if (!ROOM_ATYPE[asset.atype]) {\n          asset.asset = asset.id // asset.tag || asset.asset\n          asset.room = asset.room || asset.room_id\n          assetMap[asset.id] = asset\n          \n        \n          asset.xco = asset.xco || asset.xval\n          asset.yco = asset.yco || asset.yval\n\n        } else {\n          asset.room = asset.room || asset.name\n          roomMap[asset.room] = asset\n          asset.poly = asset.polygon.points\n        }\n        asset.map = asset.map\n        asset.level = asset.level\n        asset.building = asset.building || asset.building_id\n      \n\n        if (null != asset.level && '' !== asset.level) {\n          if(!levels.includes(asset.level)) {\n            levels.push(asset.level)\n          }\n          \n        }\n\n        if (null != asset.building && '' !== asset.building) {\n          buildings.add(asset.building)\n        }\n\n        if (null != asset.map && '' !== asset.map) {\n          if(!maps.includes(asset.map)) {\n            maps.push(asset.map)\n          }\n        }\n\n\n        // Build each relation.\n        relate.forEach(r => {\n\n\n          // Build a Child-to-Parent\n          if (r.cp && (!r.exclude || !r.exclude(asset)) && (!r.include || r.include(asset))) {\n            let pv = make_parent_val(r, asset)\n            // console.error('pv: ', pv)\n            deps.cp[r.c] = (deps.cp[r.c] || {})\n            deps.cp[r.c][asset[r.c]] = pv\n          }\n\n          // Build a Parent-to-Child\n          if (r.pc && (!r.exclude || !r.exclude(asset)) && (!r.include || r.include(asset))) {\n            let pk = make_parent_key(r, asset)\n\n            // console.error('r.pc: ', r.p, pk, asset)\n            // console.log('PK',pk)\n\n            deps.pc[r.p] = (deps.pc[r.p] || {})\n            deps.pc[r.p][pk] = (deps.pc[r.p][pk] || {})\n            deps.pc[r.p][pk][r.c] = (deps.pc[r.p][pk][r.c] || [])\n\n            let cid = make_child_id(r, asset)\n\n            // insert_child(deps.pc[r.p][pk][r.c],''+asset[r.c])\n            insert_child(deps.pc[r.p][pk][r.c], cid)\n          \n            // deps.pc[r.p][pk][r.c] = [ ... deps.pc[r.p][pk][r.c] ]\n          \n          }\n        })\n      })\n    \n   })\n\n    // maps = [...maps]\n    // levels = [...levels]\n    buildings = Array.from(buildings)\n\n    return {\n      deps,\n      maps,\n      levels,\n      buildings,\n      assetMap,\n      roomMap\n    }\n\n  }\n  \n  function depsUnitTest(deps) {\n    const { deepEqual, deepStrictEqual } = require('assert')\n    \n    let copy = JSON.parse(JSON.stringify(require('./test_data.json').deps))\n    \n    console.log( deps, copy )\n    \n    deepStrictEqual(deps, copy, 'deepEqual Relations test')\n  }\n  \n  \n    \n  W.PlantQuestAssetMap = new PlantQuestAssetMap()\n\n\n  function injectStyle() {\n    const head = $('head')\n    const style = document.createElement('style')\n    style.innerHTML = `\n\n#plantquest-assetmap {\n    background-color: rgb(203,211,144);\n}\n\n#plantquest-assetmap-map {\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    padding: 0;\n    background-color: rgb(203,211,144);\n}\n\n\ndiv.plantquest-assetmap-vis {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1000;\n}\n\n\nimg.plantquest-assetmap-logo {\n    cursor: pointer;\n}\n\n\ndiv.plantquest-assetmap-asset-label {\n    xwidth: 96px;\n    xheight: 48px;\n    font-size: 16px;\n    xoverflow: hidden;\n    z-index: 1000;\n}\n\ndiv.plantquest-assetmap-asset-cluster {\n    xwidth: 96px;\n    xheight: 48px;\n    font-size: 16px;\n    xoverflow: hidden;\n    z-index: 1000;\n}\n\n\ndiv.plantquest-assetmap-asset-label-green {\n    xcolor: #696;\n    color: white;\n    border: 2px solid #696;\n    border-radius: 4px;\n    background-color: rgba(102,153,102,0.8);\n}\n\ndiv.plantquest-assetmap-asset-label-red {\n    xcolor: #f66;\n    color: white;\n    border: 2px solid #f66;\n    border-radius: 4px;\n    background-color: rgba(255,102,102,0.8);\n}\n\n#plantquest-assetmap-assetinfo {\n    display: none;\n}\n\n#plantquest-assetmap-assetcluster {\n    display: none;\n}\n\n\n\n/* \n * Leaflet 1.8.0, a JS library for interactive maps. https://leafletjs.com\n * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade\n * BSD 2-Clause License, See https://leafletjs.com/\n */\n\n.leaflet-tile,.leaflet-zoom-anim .leaflet-zoom-hide{visibility:hidden}.leaflet-image-layer,.leaflet-layer,.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-pane,.leaflet-pane>canvas,.leaflet-pane>svg,.leaflet-tile,.leaflet-tile-container,.leaflet-zoom-box{position:absolute;left:0;top:0}.leaflet-container{overflow:hidden;-webkit-tap-highlight-color:transparent;background:#ddd;outline:0;font:12px/1.5 \"Helvetica Neue\",Arial,Helvetica,sans-serif}.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-user-drag:none}.leaflet-overlay-pane svg,.leaflet-tooltip{-moz-user-select:none}.leaflet-tile::selection{background:0 0}.leaflet-safari .leaflet-tile{image-rendering:-webkit-optimize-contrast}.leaflet-safari .leaflet-tile-container{width:1600px;height:1600px;-webkit-transform-origin:0 0}.leaflet-control-layers label,.leaflet-marker-icon,.leaflet-marker-shadow{display:block}.leaflet-container .leaflet-marker-pane img,.leaflet-container .leaflet-overlay-pane svg,.leaflet-container .leaflet-shadow-pane img,.leaflet-container .leaflet-tile,.leaflet-container .leaflet-tile-pane img,.leaflet-container img.leaflet-image-layer{max-width:none!important;max-height:none!important}.leaflet-container.leaflet-touch-zoom{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.leaflet-container.leaflet-touch-drag{-ms-touch-action:pinch-zoom;touch-action:none;touch-action:pinch-zoom}.leaflet-container.leaflet-touch-drag.leaflet-touch-zoom{-ms-touch-action:none;touch-action:none}.leaflet-container a{-webkit-tap-highlight-color:rgba(51,181,229,0.4);color:#0078a8}.leaflet-tile{filter:inherit}.leaflet-tile-loaded{visibility:inherit}.leaflet-zoom-box{width:0;height:0;-moz-box-sizing:border-box;box-sizing:border-box;z-index:800}.leaflet-overlay-pane,.leaflet-pane{z-index:400}.leaflet-map-pane svg,.leaflet-tile-pane{z-index:200}.leaflet-shadow-pane{z-index:500}.leaflet-marker-pane{z-index:600}.leaflet-tooltip-pane{z-index:650}.leaflet-popup-pane{z-index:700}.leaflet-map-pane canvas{z-index:100}.leaflet-vml-shape{width:1px;height:1px}.lvml{behavior:url(#default#VML);display:inline-block;position:absolute}.leaflet-control{position:relative;z-index:800;pointer-events:visiblePainted;pointer-events:auto;float:left;clear:both}.leaflet-bottom,.leaflet-top{position:absolute;z-index:1000;pointer-events:none}.leaflet-top{top:0}.leaflet-right{right:0}.leaflet-bottom{bottom:0}.leaflet-left{left:0}.leaflet-right .leaflet-control{float:right;margin-right:10px}.leaflet-top .leaflet-control{margin-top:10px}.leaflet-bottom .leaflet-control{margin-bottom:10px}.leaflet-left .leaflet-control{margin-left:10px}.leaflet-fade-anim .leaflet-tile{will-change:opacity}.leaflet-fade-anim .leaflet-popup{opacity:0;-webkit-transition:opacity .2s linear;-moz-transition:opacity .2s linear;transition:opacity .2s linear}.leaflet-fade-anim .leaflet-map-pane .leaflet-popup{opacity:1}.leaflet-zoom-animated{-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}.leaflet-zoom-anim .leaflet-zoom-animated{will-change:transform;-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.25,1);-moz-transition:-moz-transform .25s cubic-bezier(0,0,.25,1);transition:transform .25s cubic-bezier(0,0,.25,1)}.leaflet-pan-anim .leaflet-tile,.leaflet-zoom-anim .leaflet-tile{-webkit-transition:none;-moz-transition:none;transition:none}.leaflet-interactive{cursor:pointer}.leaflet-grab{cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.leaflet-crosshair,.leaflet-crosshair .leaflet-interactive{cursor:crosshair}.leaflet-control,.leaflet-popup-pane{cursor:auto}.leaflet-dragging .leaflet-grab,.leaflet-dragging .leaflet-grab .leaflet-interactive,.leaflet-dragging .leaflet-marker-draggable{cursor:move;cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.leaflet-image-layer,.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-pane>svg path,.leaflet-tile-container{pointer-events:none}.leaflet-image-layer.leaflet-interactive,.leaflet-marker-icon.leaflet-interactive,.leaflet-pane>svg path.leaflet-interactive,svg.leaflet-image-layer.leaflet-interactive path{pointer-events:visiblePainted;pointer-events:auto}.leaflet-container a.leaflet-active{outline:orange solid 2px}.leaflet-zoom-box{border:2px dotted #38f;background:rgba(255,255,255,.5)}.leaflet-bar{box-shadow:0 1px 5px rgba(0,0,0,.65);border-radius:4px}.leaflet-bar a,.leaflet-bar a:hover{background-color:#fff;border-bottom:1px solid #ccc;width:26px;height:26px;line-height:26px;display:block;text-align:center;text-decoration:none;color:#000}.leaflet-bar a,.leaflet-control-layers-toggle{background-position:50% 50%;background-repeat:no-repeat;display:block}.leaflet-bar a:hover{background-color:#f4f4f4}.leaflet-bar a:first-child{border-top-left-radius:4px;border-top-right-radius:4px}.leaflet-bar a:last-child{border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:none}.leaflet-bar a.leaflet-disabled{cursor:default;background-color:#f4f4f4;color:#bbb}.leaflet-touch .leaflet-bar a{width:30px;height:30px;line-height:30px}.leaflet-touch .leaflet-bar a:first-child{border-top-left-radius:2px;border-top-right-radius:2px}.leaflet-touch .leaflet-bar a:last-child{border-bottom-left-radius:2px;border-bottom-right-radius:2px}.leaflet-control-zoom-in,.leaflet-control-zoom-out{font:bold 18px 'Lucida Console',Monaco,monospace;text-indent:1px}.leaflet-touch .leaflet-control-zoom-in,.leaflet-touch .leaflet-control-zoom-out{font-size:22px}.leaflet-control-layers{box-shadow:0 1px 5px rgba(0,0,0,.4);background:#fff;border-radius:5px}.leaflet-control-layers-toggle{background-image:url(images/layers.png);width:36px;height:36px}.leaflet-retina .leaflet-control-layers-toggle{background-image:url(images/layers-2x.png);background-size:26px 26px}.leaflet-touch .leaflet-control-layers-toggle{width:44px;height:44px}.leaflet-control-layers .leaflet-control-layers-list,.leaflet-control-layers-expanded .leaflet-control-layers-toggle{display:none}.leaflet-control-layers-expanded .leaflet-control-layers-list{display:block;position:relative}.leaflet-control-layers-expanded{padding:6px 10px 6px 6px;color:#333;background:#fff}.leaflet-control-layers-scrollbar{overflow-y:scroll;overflow-x:hidden;padding-right:5px}.leaflet-control-layers-selector{margin-top:2px;position:relative;top:1px}.leaflet-control-layers-separator{height:0;border-top:1px solid #ddd;margin:5px -10px 5px -6px}.leaflet-default-icon-path{background-image:url(images/marker-icon.png)}.leaflet-container .leaflet-control-attribution{background:rgba(255,255,255,.7);margin:0}.leaflet-control-attribution,.leaflet-control-scale-line{padding:0 5px;color:#333}.leaflet-control-attribution a{text-decoration:none}.leaflet-control-attribution a:hover{text-decoration:underline}.leaflet-container .leaflet-control-attribution,.leaflet-container .leaflet-control-scale{font-size:11px}.leaflet-left .leaflet-control-scale{margin-left:5px}.leaflet-bottom .leaflet-control-scale{margin-bottom:5px}.leaflet-control-scale-line{border:2px solid #777;border-top:none;line-height:1.1;padding:2px 5px 1px;font-size:11px;white-space:nowrap;overflow:hidden;-moz-box-sizing:border-box;box-sizing:border-box;background:rgba(255,255,255,.5)}.leaflet-control-scale-line:not(:first-child){border-top:2px solid #777;border-bottom:none;margin-top:-2px}.leaflet-control-scale-line:not(:first-child):not(:last-child){border-bottom:2px solid #777}.leaflet-touch .leaflet-bar,.leaflet-touch .leaflet-control-attribution,.leaflet-touch .leaflet-control-layers{box-shadow:none}.leaflet-touch .leaflet-bar,.leaflet-touch .leaflet-control-layers{border:2px solid rgba(0,0,0,.2);background-clip:padding-box}.leaflet-popup{position:absolute;text-align:center;margin-bottom:20px}.leaflet-popup-content-wrapper{padding:1px;text-align:left;border-radius:12px}.leaflet-popup-content{margin:13px 19px;line-height:1.4}.leaflet-popup-content p{margin:18px 0}.leaflet-popup-tip-container{width:40px;height:20px;position:absolute;left:50%;margin-left:-20px;overflow:hidden;pointer-events:none}.leaflet-popup-tip{width:17px;height:17px;padding:1px;margin:-10px auto 0;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.leaflet-popup-content-wrapper,.leaflet-popup-tip{background:#fff;color:#333;box-shadow:0 3px 14px rgba(0,0,0,.4)}.leaflet-container a.leaflet-popup-close-button{position:absolute;top:0;right:0;padding:4px 4px 0 0;border:none;text-align:center;width:18px;height:14px;font:700 16px/14px Tahoma,Verdana,sans-serif;color:#c3c3c3;text-decoration:none;background:0 0}.leaflet-container a.leaflet-popup-close-button:hover{color:#999}.leaflet-popup-scrolled{overflow:auto;border-bottom:1px solid #ddd;border-top:1px solid #ddd}.leaflet-oldie .leaflet-popup-content-wrapper{-ms-zoom:1}.leaflet-oldie .leaflet-popup-tip{width:24px;margin:0 auto}.leaflet-oldie .leaflet-popup-tip-container{margin-top:-1px}.leaflet-oldie .leaflet-control-layers,.leaflet-oldie .leaflet-control-zoom,.leaflet-oldie .leaflet-popup-content-wrapper,.leaflet-oldie .leaflet-popup-tip{border:1px solid #999}.leaflet-div-icon{background:#fff;border:1px solid #666}.leaflet-tooltip{position:absolute;padding:6px;background-color:#fff;border:1px solid #fff;border-radius:3px;color:#222;white-space:nowrap;-webkit-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;box-shadow:0 1px 3px rgba(0,0,0,.4)}.leaflet-tooltip.leaflet-clickable{cursor:pointer;pointer-events:auto}.leaflet-tooltip-bottom:before,.leaflet-tooltip-left:before,.leaflet-tooltip-right:before,.leaflet-tooltip-top:before{position:absolute;pointer-events:none;border:6px solid transparent;background:0 0;content:\"\"}.leaflet-tooltip-bottom{margin-top:6px}.leaflet-tooltip-top{margin-top:-6px}.leaflet-tooltip-bottom:before,.leaflet-tooltip-top:before{left:50%;margin-left:-6px}.leaflet-tooltip-top:before{bottom:0;margin-bottom:-12px;border-top-color:#fff}.leaflet-tooltip-bottom:before{top:0;margin-top:-12px;margin-left:-6px;border-bottom-color:#fff}.leaflet-tooltip-left{margin-left:-6px}.leaflet-tooltip-right{margin-left:6px}.leaflet-tooltip-left:before,.leaflet-tooltip-right:before{top:50%;margin-top:-6px}.leaflet-tooltip-left:before{right:0;margin-right:-12px;border-left-color:#fff}.leaflet-tooltip-right:before{left:0;margin-left:-12px;border-right-color:#fff}\n\n/* MIT LICENSE, Copyright (c) 2014-2015, Justin Manley */\n.leaflet-toolbar-0{list-style:none;padding-left:0;border:2px solid rgba(0,0,0,.2);border-radius:4px}.leaflet-toolbar-0>li{position:relative}.leaflet-toolbar-0>li>.leaflet-toolbar-icon{display:block;width:30px;height:30px;line-height:30px;margin-right:0;padding-right:0;border-right:0;text-align:center;text-decoration:none;background-color:#fff}.leaflet-toolbar-0>li>.leaflet-toolbar-icon:hover{background-color:#f4f4f4}.leaflet-toolbar-0 .leaflet-toolbar-1{display:none;list-style:none}.leaflet-toolbar-tip-container{margin:-16px auto 0;height:16px;position:relative;overflow:hidden}.leaflet-toolbar-tip{width:16px;height:16px;margin:-8px auto 0;background-color:#fff;border:2px solid rgba(0,0,0,.2);background-clip:content-box;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);border-radius:4px}.leaflet-control-toolbar .leaflet-toolbar-1>li:last-child>.leaflet-toolbar-icon,.leaflet-popup-toolbar>li:last-child>.leaflet-toolbar-icon{border-top-right-radius:4px;border-bottom-right-radius:4px}.leaflet-control-toolbar>li>.leaflet-toolbar-icon{border-bottom:1px solid #ccc}.leaflet-control-toolbar>li:first-child>.leaflet-toolbar-icon{border-top-left-radius:4px;border-top-right-radius:4px}.leaflet-control-toolbar>li:last-child>.leaflet-toolbar-icon{border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-width:0}.leaflet-control-toolbar .leaflet-toolbar-1{margin:0;padding:0;position:absolute;left:30px;top:0;white-space:nowrap;height:30px}.leaflet-control-toolbar .leaflet-toolbar-1>li{display:inline-block}.leaflet-control-toolbar .leaflet-toolbar-1>li>.leaflet-toolbar-icon{display:block;background-color:#919187;border-left:1px solid #aaa;color:#fff;font:11px/19px \"Helvetica Neue\",Arial,Helvetica,sans-serif;line-height:30px;text-decoration:none;padding-left:10px;padding-right:10px;height:30px}.leaflet-control-toolbar .leaflet-toolbar-1>li>.leaflet-toolbar-icon:hover{background-color:#a0a098}.leaflet-popup-toolbar{position:relative;box-sizing:content-box}.leaflet-popup-toolbar>li{float:left}.leaflet-popup-toolbar>li>.leaflet-toolbar-icon{border-right:1px solid #ccc}.leaflet-popup-toolbar>li:first-child>.leaflet-toolbar-icon{border-top-left-radius:4px;border-bottom-left-radius:4px}.leaflet-popup-toolbar>li:last-child>.leaflet-toolbar-icon{border-bottom-width:0;border-right:none}.leaflet-popup-toolbar .leaflet-toolbar-1{position:absolute;top:30px;left:0;padding-left:0}.leaflet-popup-toolbar .leaflet-toolbar-1>li>.leaflet-toolbar-icon{position:relative;float:left;width:30px;height:30px}\n.marker-cluster-small {\n\tbackground-color: rgba(181, 226, 140, 0.6);\n\t}\n.marker-cluster-small div {\n\tbackground-color: rgba(110, 204, 57, 0.6);\n\t}\n\n.marker-cluster-medium {\n\tbackground-color: rgba(241, 211, 87, 0.6);\n\t}\n.marker-cluster-medium div {\n\tbackground-color: rgba(240, 194, 12, 0.6);\n\t}\n\n.marker-cluster-large {\n\tbackground-color: rgba(253, 156, 115, 0.6);\n\t}\n.marker-cluster-large div {\n\tbackground-color: rgba(241, 128, 23, 0.6);\n\t}\n\n\t/* IE 6-8 fallback colors */\n.leaflet-oldie .marker-cluster-small {\n\tbackground-color: rgb(181, 226, 140);\n\t}\n.leaflet-oldie .marker-cluster-small div {\n\tbackground-color: rgb(110, 204, 57);\n\t}\n\n.leaflet-oldie .marker-cluster-medium {\n\tbackground-color: rgb(241, 211, 87);\n\t}\n.leaflet-oldie .marker-cluster-medium div {\n\tbackground-color: rgb(240, 194, 12);\n\t}\n\n.leaflet-oldie .marker-cluster-large {\n\tbackground-color: rgb(253, 156, 115);\n\t}\n.leaflet-oldie .marker-cluster-large div {\n\tbackground-color: rgb(241, 128, 23);\n}\n\n.marker-cluster {\n\tbackground-clip: padding-box;\n\tborder-radius: 20px;\n\t}\n.marker-cluster div {\n\twidth: 30px;\n\theight: 30px;\n\tmargin-left: 5px;\n\tmargin-top: 5px;\n\n\ttext-align: center;\n\tborder-radius: 15px;\n\tfont: 12px \"Helvetica Neue\", Arial, Helvetica, sans-serif;\n\t}\n.marker-cluster span {\n\tline-height: 30px;\n\t}\n.leaflet-cluster-anim .leaflet-marker-icon, .leaflet-cluster-anim .leaflet-marker-shadow {\n\t-webkit-transition: -webkit-transform 0.3s ease-out, opacity 0.3s ease-in;\n\t-moz-transition: -moz-transform 0.3s ease-out, opacity 0.3s ease-in;\n\t-o-transition: -o-transform 0.3s ease-out, opacity 0.3s ease-in;\n\ttransition: transform 0.3s ease-out, opacity 0.3s ease-in;\n}\n\n.leaflet-cluster-spider-leg {\n\t/* stroke-dashoffset (duration and function) should match with leaflet-marker-icon transform in order to track it exactly */\n\t-webkit-transition: -webkit-stroke-dashoffset 0.3s ease-out, -webkit-stroke-opacity 0.3s ease-in;\n\t-moz-transition: -moz-stroke-dashoffset 0.3s ease-out, -moz-stroke-opacity 0.3s ease-in;\n\t-o-transition: -o-stroke-dashoffset 0.3s ease-out, -o-stroke-opacity 0.3s ease-in;\n\ttransition: stroke-dashoffset 0.3s ease-out, stroke-opacity 0.3s ease-in;\n}\n\n\n.leaflet-toolbar-0>li>.leaflet-toolbar-icon {\n  width: 80px;\n}\n\n.control-panel {\n  position: absolute;\n  top: 0em;\n  left: 5em;\n  background-color: white;\n  border: 1px solid black;\n  width: 10em;\n  height: 6em;\n  padding: 10px;\n  font-size: 14px;\n  font-family: Arial, sans-serif;\n  word-wrap: break-word;\n  height: fit-content;\n  width: fit-content;\n  opacity: 0.5;\n  /*block-size: fit-content;*/\n}\n\n\n.class1 {\n    background-color: transparent;\n    border: 0;\n    box-shadow: none;\n} \n\n.polygon-labels {\n  background-color: transparent;\n  font-weight: bold;\n  color: #000000;\n  border: 0;\n  box-shadow: none;\n  font-size: 1em;\n}\n\ndiv.plantquest-assetmap-asset-label {\n    width: 200px;\n}\n\ndiv.plantquest-assetmap-asset-state-up {\n    color: white;\n    border: 2px solid #696;\n    border-radius: 4px;\n    background-color: #696;\n    opacity: 0;\n}\n\ndiv.plantquest-assetmap-asset-state-down {\n    color: white;\n    border: 2px solid #666;\n    border-radius: 4px;\n    background-color: #666;\n    opacity: 0.7;\n}\n\ndiv.plantquest-assetmap-asset-state-missing {\n    color: white;\n    border: 2px solid #f3f;\n    border-radius: 4px;\n    background-color: #f3f;\n    opacity: 0.7;\n}\n\ndiv.plantquest-assetmap-asset-state-alarm {\n    color: white;\n    border: 2px solid #f33;\n    border-radius: 4px;\n    background-color: #f33;\n    opacity: 0.7;\n}\n\n`\n    head.appendChild(style)\n  }\n  \n})(window, document);\n\n"],"names":["t","o","i","L","Toolbar2","Layer","Class","extend","statics","baseClass","options","className","filter","actions","initialize","setOptions","_toolbar_type","constructor","_toolbar_class_id","addTo","_arguments","slice","call","arguments","addLayer","onAdd","_toolbars","_calculateDepth","removeLayer","onRemove","appendToContainer","e","n","s","_container","_ul","DomUtil","create","_disabledEvents","length","DomEvent","on","stopPropagation","_getActionConstructor","_createIcon","prototype","apply","enable","_active","disable","_hide","style","display","_show","parentToolbar","Evented","include","Mixin","Events","toolbar","Map","addInitHook","Action","Handler","toolbarIcon","html","tooltip","subToolbar","preventDefault","_enabled","addHooks","removeHooks","_icon","_link","innerHTML","setAttribute","addClass","_addSubToolbar","push","toolbarAction","extendOptions","Control","_control","Toolbar","getContainer","remove","removeFrom","control","Popup","anchor","_marker","Marker","icon","DivIcon","iconAnchor","_map","_setStyles","setLatLng","point","a","querySelectorAll","l","r","c","h","parentNode","parseInt","getStyle","Math","ceil","parseFloat","width","_tipContainer","_tip","max","height","Point","marginLeft","x","marginTop","y","popup","window","require$$0","W","D","PLANTQUEST_ASSETMAP_DEBUG","log","_len","args","Array","_key","PLANTQUEST_ASSETMAP_LOG","console","scriptID","random","substring","Pkg","version","PlantQuestAssetMap","id","$","querySelector","bind","$All","Element","createElement","rc","self","info","name","config","domInterval","mapInterval","mapBounds","mapImg","mapStart","mapStartZoom","mapRoomFocusZoom","mapMinZoom","mapMaxZoom","assetFontScaleRoom","assetFontScaleZoom","assetFontHideZoom","showAllAssets","debugClick","infobox","show","single","data","mode","apikey","endpoint","tilesEndPoint","states","up","color","marker","down","missing","alarm","map","start","level","room","label","zoom","plants","asset","cluster","assetMap","roomMap","current","started","assetInfoShown","upload","assetI","interval","listeners","_len2","_key2","concat","clearRoomAssets","unselectRoom","setView","_extends","JSON","stringify","base","endsWith","loading","target","clearInterval","loadingInterval","load","render","emit","srv","part","state","setInterval","done","reset","deps","assets","rooms","buildings","levels","maps","processData","json","assetProps","_loop","row","rowI","assetID","reduce","p","Promise","resolve","reject","loadData","dataLoaded","query","project_id","plant_id","stage","seneca","post","then","_ref","_ref2","_ref3","_generate","generate","getSeneca","head","skript","document","appendChild","waiter","PLANTQUEST_ASSETMAP_DATA","fetch","response","ok","Error","status","err","injectStyle","root","boxSizing","backgroundColor","padding","textAlign","position","buildContainer","setTimeout","vis","elem","build","showMap","send","msg","result","setZoom","view","listen","listener","toString","replace","click","what","event","Object","assign","forEach","ctrl","loc","poly","chosen","stateShown","leaflet","layer","ms","mapurl","bounds","crs","CRS","Simple","scrollWheelZoom","doubleClickZoom","attributionControl","minZoom","maxZoom","RasterCoords","createPane","getPane","zIndex","pointerEvents","layerGroup","name$","zoomStartRender","zoomEndRender","c_asset_coords","mapCenter","getCenter","circles","markerClusterGroup","animateAddingMarkers","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","chunkedLoading","spiderLegPolylineOptions","weight","opacity","spiderfyLinear","spiderfyLinearDistance","spiderfyLinearSeparation","clusterInfo","mev","_convert_latlng","convert_latlng","latlng","xco","yco","assetlist","getAllChildMarkers","closeAssetInfo","div","zIndexOffset","divIcon","MarkerCluster","assetCurrent","lem","getElement","fontSize","blinkId","blink","blinkState","generate_labels","poly_labels","_iterator","_createForOfIteratorHelperLoose","_step","value","area","room_poly","convertRoomPoly","polygon","pane","permanent","direction","bindTooltip","_c","getBounds","setContent","createDebugLog","content","debugLog","container","_div","textContent","disableClickPropagation","disableScrollPropagation","_convert_latlng2","asset_data","addControl","meta","show_coords","tag","_convert_latlng3","levelActions","index","plant","getZoom","pos","labels","prev_labels","labelZoomLevel","_iterator2","_step2","_iterator3","_step3","setLabel","_iterator4","_step4","_iterator5","_step5","checkRooms","convert_poly_y","values","_loop2","_rooms","_i","alarmState","inside","pointInPolygon","alreadyShown","drawRoom","roomState","selectRoom","message","_ret","roomId","opts","isChosen","focusRoom","prevRoom","prevRoomState","popop","roomlatlng","roompos_y","roompos_x","roompos","autoClose","closeOnClick","roomPopup","openOn","showRoomAssets","mute","select","setStyle","resolveRoomColor","_iterator6","_step6","showRoom","stateName","keys","stateDef","alertRoomState","roomCurrent","roomID","newStateDef","actualStateDef","newPriority","indexOf","pc","_iterator7","_step7","assetState","priority","assetDesc","showAsset","hide","assetPoint","ax","ay","ay_poly","circle","radius","setOpacity","cp","_iterator8","_step8","getUrl","mapIndex","createTile","tileLyr","tileLayer","getMaxBounds","maptile","hilo","join","getRoomAssets","roomEntry","suffix","origin","url","Seneca","logger","plugin","browser","headers","timeout","test","use","SenecaEntity","ready","_this","client","type","pin","fix","removeAsset","_this2","removeRoom","_this3","_this4","building","_this5","_this5$post","save","_this6","_this6$post","_this7","_this7$post","_this8","_this9","_this10","_this11","list","_this12","_this13","_iterator9","_step9","focus","assetShow","relate","relation","clone","isArray","_iterator10","_step10","assetData","before","showInfoBox","assetRoom","coords","obj","parse","vs","end","pointInPolygonNested","pointInPolygonFlat","undefined","len","j","xi","yi","xj","yj","intersect","img","_iterator11","_step11","unproject","Lng","project","floor","_ref4","make_parent_key","split","pn","make_parent_val","make_child_id","insert_child","arr","child","splice","Set","add","collection","ROOM_ATYPE","exclude","atype","room_id","xval","yval","points","building_id","includes","pv","pk","cid","from"],"mappings":"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"}